<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <title>Каталог товаров</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        h1 { color: #333; }
        ul { list-style-type: none; padding: 0; }
        li { 
            padding: 10px; 
            border-bottom: 1px solid #ddd; 
            display: flex; 
            justify-content: space-between; 
        }
        .price { font-weight: bold; }
    </style>
</head>
<body>
    <h1>Каталог товаров</h1>
    <ul>
        {% for product in products %}
            <li>
                <span>{{ product.title }} ({{ product.shop.name }})</span>
                <span class="price">{{ product.price }}₸</span>
            </li>
        {% empty %}
            <li>Товары отсутствуют</li>
        {% endfor %}
    </ul>
</body>
</html>
<script src="https://telegram.org/js/telegram-web-app.js"></script>
<script>
    const tg = window.Telegram.WebApp;
    tg.ready();

    // Данные пользователя Telegram
    const tgUser = tg.initDataUnsafe.user;

    if (tgUser) {
        // Отправляем на наш API для логина
        fetch('/api/login/', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(tgUser)
        })
        .then(res => res.json())
        .then(data => {
            console.log('Токен для API:', data.token);
            // Можно сохранять token в localStorage или в переменную JS
        })
        .catch(err => console.error(err));
    }
</script>
